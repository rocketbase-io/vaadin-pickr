<link rel="import" href="../bower_components/polymer/polymer-element.html">
<dom-module id="vaadin-pickr">
    <template>
        <link rel="stylesheet" href="/frontend/pickr.css">
        <div class="vaadin-pickr-container">
            <div class="pickr">COLOR_PICKER</div>
        </div>
    </template>
    <script>
        class VaadinPickr extends Polymer.Element {

            static get properties() {
                return {
                    pickrOptions: {
                        type: String,
                        observer: '_pickrOptionsChanged'
                    }
                };
            }

            static get is() {
                return 'vaadin-pickr';
            }

            constructor() {
                super();
            }

            _pickrOptionsChanged(newValue) {
                this.config = JSON.parse(newValue);
                this.config.el = this.shadowRoot.querySelector('.pickr');
                this.pickr = new Pickr(this.config);
                this.pickr.on('save', (...args) => {
                    this.updateColor(args[0]);
                });
            }

            updateColor(colorObject) {
                var vaadinServer = this.$server;
                vaadinServer.colorChanged(colorObject.toHEX().toString());
            }
        }

        window.customElements.define(VaadinPickr.is, VaadinPickr);

    </script>
</dom-module>
